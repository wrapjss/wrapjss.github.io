modules.wrap = {};

modules.wrap.crucial = async () => {
  if (localStorage.getItem("wraptop._vp") !== "true") {
    showPopUp("Welcome to Wraptop!",
      "Wraptop is a client made by <a href='https://wrapjss.github.io/?user=wrap#profile'>@wrapjss</a> with usability and user comfort in mind. Wraptop offers uality of life and developmental features for users and developers alike.",
      [["Okay", "var(--themeColor)", () => {
        localStorage.setItem("wraptop._vp", "true");
      }]]
    );

    if (!("Notification" in window)) {
      showPopUp("Wraptop Alert",
        "Your browser does not support the Notification API, so you won't recieve notifications for new posts. Consider updating to a newer browser in order to recieve notifications.",
        [["Ok", "var(--themeColor)"]]
      );
    } else if (Notification.permission !== "granted") {
      showPopUp("Permission grant",
        "Would you like to recieve new post notifications?",
        [
          ["Yes", "var(--themeColor)", () => {
            Notification.requestPermission()
              .then((permission) => {
                if (permission == "granted") {
                  new Notification("Woohoo!", {
                    body: "You'll now be recieving notifications for new posts.",
                    icon: "data:image/jpeg;base64,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"
                  })
                }
              });
          }],
          [
            "No",
            "var(--grayColor)"
          ]
        ]
      )
    }
  }
}

async function wrap_gp(pid) {
  return new Promise(async (resolve, reject) => {
    const [code, response] = await sendRequest("GET", `posts/get?postid=${pid}`);

    resolve(JSON.parse(response));
  });
}

modules.wrap.onPost = async (post) => {
  post = await wrap_gp(post._id);
  let author = post["users"][0];
  post = post["posts"][0];
  console.log(post);

  if (document.hidden && Notification.permission == "granted") {
    if (!post.Media) {
      const notif_ = new Notification(`${author.User} (Photop)`, {
        icon: `https://photop-content.s3.amazonaws.com/ProfileImages/${author?.Settings?.ProfilePic || "DefaultProfilePic"}`,
        body: `${post?.Text || "Error, the post only has an image or poll but no text."}`
      });
    } else {
      const notif_ = new Notification(`${author.User} (Photop)`, {
        icon: `https://photop-content.s3.amazonaws.com/ProfileImages/${author?.Settings?.ProfilePic || "DefaultProfilePic"}`,
        body: `${post?.Text || "Error, the post only has an image or poll but no text."}`,
        image: `https://photop-content.s3.amazonaws.com/PostImages/${post?._id}0`
      });
    }

    console.log(notif_);
  }
}